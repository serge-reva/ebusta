# Ebusta: Система поиска и доставки контента

## Архитектура системы (Pipeline)

Система построена на принципах микросервисной архитектуры с использованием gRPC для межсервисного взаимодействия. Весь путь сообщения от пользователя до данных разделен на изолированные этапы.

### Схема потока данных (Data Flow)
`User Input -> Adapter -> MessageConverter -> Processor -> Data-Manager`

---

## Компоненты системы

### 1. Adapters (Входные шлюзы)
**Пример:** `cmd/web-adapter`
- **Функция:** Прием сырых данных из внешних интерфейсов (HTTP, TG, IRC).
- **Ответственность:** Только транспортный уровень. Преобразует внешние запросы в gRPC-вызов `MessageConverter.Convert`.

### 2. MessageConverter (Семантический анализатор)
**Путь:** `cmd/message-converter`
- **Функция:** Парсинг и нормализация.
- **Задача:** Извлекает "Намерение" (Intent) и очищенные данные (Payload).
- **UnifiedMessage:** Объект, который гарантирует, что `Processor` получит стандартизированные данные независимо от источника.

### 3. Processor (Бизнес-логика / Оркестратор)
**Путь:** `cmd/processor`
- **Функция:** Маршрутизация и принятие решений.
- **Логика:**
    - Если `Intent == "search"`, запрашивает данные у `Data-Manager`.
    - Если `Intent == "download"`, инициирует процесс загрузки.

### 4. Data-Manager (Слой данных)
**Путь:** `cmd/data-manager`
- **Функция:** Интерфейс к поисковому движку (OpenSearch).
- **Задача:** Выполнение поисковых запросов и возврат списка объектов `Book`.

---

## Технологический стек
- **Язык:** Go (Golang)
- **Связь:** gRPC (Protocol Buffers v3)
- **Логирование:** Logrus
- **Сборка:** Makefile

## Порты и адреса (Service Map)
| Сервис            | Порт   | Протокол |
|-------------------|--------|----------|
| Data-Manager      | :50051 | gRPC     |
| MessageConverter  | :50052 | gRPC     |
| Processor         | :50053 | gRPC     |
| Web-Adapter       | :8080  | HTTP     |

## Управление проектом
- `make run` — Запуск всего пайплайна в фоне.
- `make stop` — Безопасная остановка всех сервисов (через fuser и pkill).
- `make proto` — Генерация кода из .proto файлов.
