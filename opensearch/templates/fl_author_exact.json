{
  "script": {
    "lang": "mustache",
    "source": {
      "query": { "term": { "authors.kw": "{{author}}" } },
      "collapse": { "field": "title.kw", "inner_hits": { "name": "best", "size": 1, "sort": [{"fileInfo.size": "desc"}] } },
      "size": "{{size}}{{^size}}20{{/size}}"
    }
  }
}
