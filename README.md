# Ebusta üìö

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –ø–æ–∏—Å–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞—Ä—Ö–∏–≤–æ–≤ Flibusta. –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ –º–∏–ª–ª–∏–æ–Ω–∞–º –∑–∞–ø–∏—Å–µ–π —á–µ—Ä–µ–∑ OpenSearch, –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π DSL (Domain Specific Language).

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –ø–æ gRPC:

* **Web-Adapter (The Door)**: –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç –∏—Ö –≤ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä.
* **Orchestrator**: –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, —É–ø—Ä–∞–≤–ª—è–µ—Ç Trace-ID.
* **Message-Converter**: –ü–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫—É –∑–∞–ø—Ä–æ—Å–∞ –≤ AST-–¥–µ—Ä–µ–≤–æ.
* **Processor**: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–æ–∏—Å–∫–∞.
* **Datamanager**: –°–ª–æ–π –¥–∞–Ω–Ω—ã—Ö, —Ä–∞–±–æ—Ç–∞—é—â–∏–π —Å OpenSearch.
* **Auth-Manager**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç whitelist.
* **Ebusta-CLI**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ–±–æ–ª–æ—á–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å—Ç–µ–º–æ–π.



## üö¶ –ö–∞—Ä—Ç–∞ –ø–æ—Ä—Ç–æ–≤

| –°–µ—Ä–≤–∏—Å            | –ü–æ—Ä—Ç (gRPC) | –§—É–Ω–∫—Ü–∏–∏                          |
|:------------------|:------------|:---------------------------------|
| Datamanager       | `:50051`    | –°–ª–æ–π –¥–∞–Ω–Ω—ã—Ö (OpenSearch)         |
| Message-Converter | `:50052`    | –ü–∞—Ä—Å–µ—Ä (AST)                     |
| Processor         | `:50053`    | –õ–æ–≥–∏–∫–∞ –∏ –≤—ã–±–æ—Ä —à–∞–±–ª–æ–Ω–æ–≤          |
| Orchestrator      | `:50054`    | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è                      |
| Auth-Manager      | `:50055`    | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Whitelist)         |
| Web-Adapter       | `:8080`     | HTTP-–≤—Ö–æ–¥ (REST)                 |
| Metrics           | `:9091`     | Prometheus –º–µ—Ç—Ä–∏–∫–∏ (Datamanager) |

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
–¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Go 1.21+ –∏ Protoc.

```bash
make build   # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Proto –∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
make run     # –ó–∞–ø—É—Å–∫ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

## Ops: Prometheus metrics (orchestrator)
- Metrics endpoint: `http://localhost:50090/metrics`
- Manual helper:
  - `./scripts/ebusta_metrics.sh head`
  - `./scripts/ebusta_metrics.sh check`
  - `./scripts/ebusta_metrics.sh inc 5`

