=== КРИТИЧЕСКИЕ ПРАВИЛА ДЛЯ РАБОТЫ С ИИ НАД ПРОЕКТОМ EBUSTA ===

## ГЛАВНОЕ ПРАВИЛО
ИИ должен СНАЧАЛА ЧИТАТЬ, потом ПРЕДЛАГАТЬ, и только после ПОДТВЕРЖДЕНИЯ - ПРИМЕНЯТЬ.

## ИСТОЧНИКИ ИСТИНЫ (по приоритету)

1. **api/proto/v1/library.proto** - ОСНОВНОЙ контракт между сервисами
2. **lisp-converter/*.lisp** - логика DSL парсера
3. **cmd/*/main.go** - реализации сервисов
4. **ebusta.yaml** - конфигурация
5. **Makefile** - сборка и запуск

Документация (*.md) может быть устаревшей - доверяй коду!

## ЗАПРЕЩЕННЫЕ ДЕЙСТВИЯ

❌ **НИКОГДА не удаляй поля из proto файлов**
   - SearchRequest имеет: query, template_id, limit, offset, trace_id
   - Удаление поля = поломка всех сервисов

❌ **НИКОГДА не используй sed/awk для proto файлов**
   - Proto требует точного синтаксиса
   - Используй только ручное редактирование после просмотра

❌ **НИКОГДА не перезаписывай файлы без просмотра**
   - cat > file ТОЛЬКО после view + подтверждения

❌ **НИКОГДА не "улучшай" без запроса**
   - Не рефактори
   - Не добавляй "best practices"
   - Не меняй архитектуру

## ОБЯЗАТЕЛЬНАЯ ПРОЦЕДУРА ПЕРЕД ИЗМЕНЕНИЕМ

Для ЛЮБОГО файла:

1. **Читаем текущее состояние:**
```bash
   cat <file>  # или view в Claude
```

2. **Смотрим git diff:**
```bash
   git diff <file>
```

3. **Показываем что изменится (в формате diff):**
```
   --- old
   +++ new
   @@ -X,Y +A,B @@
   - старая строка
   + новая строка
```

4. **Спрашиваем подтверждение:**
```
   "Подтвердите изменения? (да/нет)"
```

5. **Только после "да" - применяем**

## ПРАВИЛЬНЫЙ WORKFLOW

### Пример 1: Исправление proto

❌ **НЕПРАВИЛЬНО:**
```bash
cat > api/proto/v1/library.proto << 'EOF'
...новый контент...
